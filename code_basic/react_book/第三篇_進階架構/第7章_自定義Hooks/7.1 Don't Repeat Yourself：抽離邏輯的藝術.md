# 7.1 Don't Repeat Yourself (DRY)ï¼šæŠ½é›¢é‚è¼¯çš„è—è¡“

ç•¶ä½ åœ¨å…©å€‹ä¸åŒçš„ Component ä¸­ç™¼ç¾ã€Œè¤‡è£½è²¼ä¸Šã€äº†ç›¸åŒçš„ `useEffect` æˆ– `useState` é‚è¼¯æ™‚ï¼Œå°±æ˜¯å»ºç«‹ **Custom Hook** çš„æ™‚å€™äº†ã€‚

## 1. ä»€éº¼æ˜¯ Custom Hookï¼Ÿ

Custom Hook å…¶å¯¦å°±åªæ˜¯ä¸€å€‹ **ã€Œæœƒå‘¼å«å…¶ä»– Hook çš„ JavaScript å‡½å¼ã€**ã€‚
ç‚ºäº†è®“ React è¾¨è­˜å®ƒä¸¦é€²è¡Œ Lint æª¢æŸ¥ï¼Œå‘½å**å¿…é ˆ**ä»¥ `use` é–‹é ­ï¼ˆä¾‹å¦‚ `useUser`, `useFetch`ï¼‰ã€‚

---

## 2. å¾è¤‡è£½è²¼ä¸Šåˆ°æŠ½é›¢

### ğŸ˜© ç—›é»ï¼šé‡è¤‡çš„é‚è¼¯
å‡è¨­æˆ‘æœ‰å…©å€‹å…ƒä»¶éƒ½éœ€è¦ã€Œè¿½è¹¤è¦–çª—å¯¬åº¦ã€ï¼š

```jsx
function Header() {
  const [width, setWidth] = useState(window.innerWidth);
  useEffect(() => {
    const handleResize = () => setWidth(window.innerWidth);
    window.addEventListener('resize', handleResize);
    return () => window.removeEventListener('resize', handleResize);
  }, []);
  
  return <header>Width: {width}</header>;
}

function Footer() {
  // ... ä¸€æ¨¡ä¸€æ¨£çš„ code åˆå¯«ä¸€æ¬¡ ...
}
```

### ğŸ˜ è§£æ³•ï¼šæŠ½é›¢æˆ useWindowSize
æˆ‘å€‘å¯ä»¥æŠŠé€™æ®µé‚è¼¯å‰ªä¸‹ï¼Œè²¼åˆ°ä¸€å€‹æ–°çš„å‡½å¼ä¸­ï¼š

```jsx
// hooks/useWindowSize.js
import { useState, useEffect } from 'react';

export function useWindowSize() {
  const [width, setWidth] = useState(window.innerWidth);

  useEffect(() => {
    const handleResize = () => setWidth(window.innerWidth);
    window.addEventListener('resize', handleResize);
    return () => window.removeEventListener('resize', handleResize);
  }, []);

  return width; // å›å‚³ä»»ä½•ä½ æƒ³è¦çš„è³‡æ–™
}
```

### ä½¿ç”¨å®ƒ
```jsx
function Header() {
  const width = useWindowSize();
  return <header>Width: {width}</header>;
}
```

---

## 3. Custom Hook çš„å„ªå‹¢

1. **é‚è¼¯è¤‡ç”¨**ï¼šUI ä¸åŒï¼Œä½†é‚è¼¯ç›¸åŒ (ä¾‹å¦‚è¡¨å–®è™•ç†ã€å‹•ç•«ã€è¨‚é–±)ã€‚
2. **é—œæ³¨é»åˆ†é›¢**ï¼šå…ƒä»¶åªè² è²¬æ¸²æŸ“ UIï¼Œè¤‡é›œçš„é‚è¼¯è—åœ¨ Hook è£¡ï¼Œè®“ç¨‹å¼ç¢¼æ›´ä¹¾æ·¨ã€‚
3. **å…±äº«é‚è¼¯ï¼Œä½†ä¸å…±äº«ç‹€æ…‹**ï¼šæ¯æ¬¡å‘¼å« Hookï¼Œå®ƒè£¡é¢çš„ `useState` éƒ½æ˜¯ç¨ç«‹çš„ã€‚`useWindowSize` ç”¨åœ¨ Header å’Œ Footer æ™‚ï¼Œå®ƒå€‘å„è‡ªæ“æœ‰ç¨ç«‹çš„ width state (é›–ç„¶å¾Œæœæ˜¯ä¸€æ¨£çš„)ã€‚

## å°çµ

- **DRY åŸå‰‡**ï¼šä¸è¦é‡è¤‡ç™¼æ˜è¼ªå­ã€‚
- **å‘½åè¦å‰‡**ï¼šä¸€å®šè¦ç”¨ `use` é–‹é ­ã€‚
- **æœ¬è³ª**ï¼šCustom Hook = Logic Encapsulation (é‚è¼¯å°è£)ã€‚
