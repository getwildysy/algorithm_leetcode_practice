# 7.2 Hook çš„è¦å‰‡ï¼šç‚ºä»€éº¼ä¸èƒ½åœ¨è¿´åœˆä¸­ä½¿ç”¨ Hookï¼Ÿ

React å®˜æ–¹æ–‡æª”å†ä¸‰å¼·èª¿å…©æ¢éµå¾‹ï¼š
1. **åªåœ¨æœ€é ‚å±¤å‘¼å« Hook** (Don't call Hooks inside loops, conditions, or nested functions)ã€‚
2. **åªåœ¨ React Function ä¸­å‘¼å« Hook**ã€‚

ç‚ºä»€éº¼ï¼Ÿé€™è·Ÿ React çš„åº•å±¤å¯¦ä½œæœ‰é—œã€‚

## 1. é™£åˆ—/éˆçµä¸²åˆ—ç´¢å¼•æ¨¡å‹

React å…§éƒ¨ä¸¦æ²’æœ‰ç”¨ä»€éº¼é»‘é­”æ³•ä¾†å°‡ `useState(0)` ç¶å®šåˆ°åŸæœ¬çš„è®Šæ•¸åã€‚å®ƒæ˜¯é  **ã€Œå‘¼å«é †åºã€** ä¾†è¨˜éŒ„ç‹€æ…‹çš„ã€‚

æƒ³åƒ React å…§éƒ¨æœ‰ä¸€å€‹é™£åˆ—ï¼š

```js
// React å…§éƒ¨çš„ç‹€æ…‹ç´€éŒ„ (ç°¡åŒ–ç‰ˆ)
let hooks = [];
let currentHookIndex = 0;

function useState(initialValue) {
  const state = hooks[currentHookIndex] || initialValue;
  hooks[currentHookIndex] = state;
  currentHookIndex++; // æŒ‡å‘ä¸‹ä¸€å€‹
  return [state, setState];
}
```

### ğŸ’¥ ç ´å£è¦çŸ©çš„å¾Œæœ

å‡è¨­ä½ é€™æ¨£å¯«ï¼š

```jsx
function Component({ show }) {
  // 1. name state
  const [name, setName] = useState('Mary');

  // 2. æ¢ä»¶å¼ Hook (âŒ éŒ¯èª¤ï¼)
  if (show) {
    const [surname, setSurname] = useState('Poppins');
    useEffect(() => { ... });
  }

  // 3. theme state
  const [theme, setTheme] = useState('dark');
}
```

#### ç¬¬ä¸€æ¬¡æ¸²æŸ“ (show = true)
1. Index 0: `name` ('Mary')
2. Index 1: `surname` ('Poppins')
3. Index 2: `useEffect`
4. Index 3: `theme` ('dark')

#### ç¬¬äºŒæ¬¡æ¸²æŸ“ (show = false)
1. Index 0: `name` ('Mary') -> OK
2. Index 1: **React ä»¥ç‚ºé€™è£¡æ˜¯ surnameï¼Œä½†å…¶å¯¦ä½ è·³éäº†ï¼** React æœƒæŠŠåŸæœ¬å­˜åœ¨ Index 1 çš„ 'Poppins' ä¸Ÿçµ¦ç¾åœ¨çš„ `theme`ã€‚
   -> **å´©æ½°ï¼** `theme` è®Šæˆäº† 'Poppins'ï¼Œå¾Œé¢çš„æ‰€æœ‰ Hook é †åºå¤§äº‚ã€‚

---

## 2. ESLint Plugin

ç‚ºäº†é˜²æ­¢é€™ç¨®äººé¡é›£ä»¥å¯Ÿè¦ºçš„éŒ¯èª¤ï¼ŒReact æä¾›äº† `eslint-plugin-react-hooks`ã€‚
å¦‚æœä½ åœ¨ `if` æˆ– `for` è£¡é¢å¯« Hookï¼Œå®ƒæœƒç›´æ¥å ±éŒ¯ä¸­æ–·ç·¨è­¯ã€‚

**è«‹æ°¸é éµå®ˆé€™å€‹è¦å‰‡ï¼Œä¸è¦è©¦åœ–ç¹éå®ƒã€‚**

## 3. å¦‚æœæˆ‘çœŸçš„éœ€è¦åœ¨è¿´åœˆè£¡ç”¨ Hookï¼Ÿ

è«‹å°‡è¿´åœˆå…§éƒ¨çš„é …ç›® **ã€Œæ‹†åˆ†æˆç¨ç«‹çš„å­å…ƒä»¶ã€**ã€‚

```jsx
// âŒ éŒ¯èª¤
{items.map(item => {
  const [isSelected, setIsSelected] = useState(false); // éŒ¯èª¤ï¼
  return <li ... />;
})}

// âœ… æ­£ç¢º
{items.map(item => (
  <ListItem key={item.id} item={item} />
))}

function ListItem({ item }) {
  const [isSelected, setIsSelected] = useState(false); // åœ¨é€™è£¡ç”¨æ²’å•é¡Œ
  return <li ... />;
}
```

## å°çµ

- React ä¾è³´ **å‘¼å«é †åº** ä¾†è¿½è¹¤ Hooksã€‚
- **æ¢ä»¶å¼ Hook** æœƒæ‰“äº‚é †åºï¼Œå°è‡´ç‹€æ…‹éŒ¯ç½®ã€‚
- è§£æ±ºæ–¹æ¡ˆï¼šå°‡é‚è¼¯ç§»åˆ°å­å…ƒä»¶ï¼Œæˆ–å°‡æ¢ä»¶åˆ¤æ–·ç§»åˆ° Hook å…§éƒ¨èˆ‡ JSX æ¸²æŸ“è™•ã€‚
