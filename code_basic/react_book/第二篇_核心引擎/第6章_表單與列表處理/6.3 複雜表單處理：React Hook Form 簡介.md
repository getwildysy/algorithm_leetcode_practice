# 6.3 複雜表單處理：React Hook Form 簡介

當表單欄位變多（例如 20 個欄位），如果全部都用 `useState` 做受控元件，會帶來兩個問題：
1. **效能問題**：打一個字就 Trigger 整個 Form Re-render。
2. **驗證邏輯複雜**：要自己寫一大堆 `if (!email.includes('@'))`。

這時候，**React Hook Form** 就是你的救星。它是目前業界標準的表單處理庫。

## 1. 非受控元件 (Uncontrolled Components)

React Hook Form 的核心原理是基於 **Uncontrolled Components**，也就是利用 `ref` 直接操作 DOM，而不是每次都更新 State。這讓它的效能飛快。

```jsx
// 純 React 的非受控寫法 (類似 React Hook Form 底層)
const inputRef = useRef();

const handleSubmit = () => {
  alert(inputRef.current.value);
};

<input ref={inputRef} />;
```

---

## 2. React Hook Form 基本用法

首先安裝：`npm install react-hook-form`

```jsx
import { useForm } from 'react-hook-form';

function LoginForm() {
  const { 
    register, 
    handleSubmit, 
    formState: { errors } 
  } = useForm();

  const onSubmit = (data) => {
    console.log(data); // { email: "...", password: "..." }
  };

  return (
    <form onSubmit={handleSubmit(onSubmit)}>
      {/* 1. 註冊欄位與驗證規則 */}
      <input 
        {...register("email", { required: true, pattern: /^\S+@\S+$/i })} 
      />
      {errors.email && <span>Email 格式錯誤</span>}

      <input 
        type="password"
        {...register("password", { required: true, minLength: 6 })} 
      />
      {errors.password && <span>密碼至少 6 碼</span>}

      <button type="submit">登入</button>
    </form>
  );
}
```

### 關鍵 API
- **register**: 取代手寫的 `onChange` / `value` / `ref`。
- **handleSubmit**: 自動處理 `e.preventDefault()` 並執行驗證，通過才呼叫你的 `onSubmit`。
- **formState**: 包含錯誤訊息、是否被修改 (dirty)、是否正在提交 (isSubmitting) 等狀態。

---

## 3. 為什麼選它？

| 特性 | 受控元件 (useState) | React Hook Form |
| :--- | :--- | :--- |
| **渲染次數** | 每次打字都 Render | **只在提交或驗證時 Render** |
| **程式碼量** | 多 (要寫 handlers) | **少 (宣告式)** |
| **驗證邏輯** | 自己寫 | **內建標準驗證** |
| **適用場景** | 簡單表單, 即時檢核 | **複雜表單, 大量欄位** |

## 小結

- 小表單（< 3 欄位）用 State 就好。
- 中大型表單強烈建議使用 **React Hook Form**。
- 它利用 Uncontrolled Component 技術優化了效能。
